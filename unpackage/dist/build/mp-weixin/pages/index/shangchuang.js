(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/shangchuang"],{"0236":function(t,e,n){"use strict";n("4651");var i=o(n("b0ce")),a=o(n("f19c"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(a.default))},"03d9":function(t,e,n){"use strict";var i=n("2441"),a=n.n(i);a.a},2441:function(t,e,n){},"3a2f":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n("a34a")),a=o(n("f55d"));function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e,n,i,a,o,s){try{var c=t[o](s),u=c.value}catch(r){return void n(r)}c.done?e(u):Promise.resolve(u).then(i,a)}function c(t){return function(){var e=this,n=arguments;return new Promise(function(i,a){var o=t.apply(e,n);function c(t){s(o,i,a,c,u,"next",t)}function u(t){s(o,i,a,c,u,"throw",t)}c(void 0)})}}var u=n("e3f6"),r=(u.formatLocation,[["camera"],["album"],["camera","album"]]),l=[["compressed"],["original"],["compressed","original"]],d=[],f={data:function(){return{address:"请选择位置",latitude:"",longitude:"",content:"",imageList:[],sourceTypeIndex:2,sizeTypeIndex:2,countIndex:8,count:[1,2,3,4,5,6,7,8,9],xspics:[]}},onShow:function(){a.default.islogin(!0)},methods:{upload_in:function(){var e=this;e.xspics=d;for(var n="",i=0;i<e.xspics.length;i++)i==e.xspics.length-1?n+=e.xspics[i]:n+=e.xspics[i]+";";""!=e.content?0!=e.xspics.length?""!=e.address&&"请选择位置"!=e.address?(t.showLoading({mask:!0,title:"上传中..."}),t.request({url:a.default.websiteUrl+"hotlive/addhotlive",method:"POST",data:a.default.postdata({userid:a.default.getstate().userid,ctype:3,rtype:0,content:e.content,video:"",Issue:!0,pics:n,position:e.address,Lat:e.latitude,lng:e.longitude}),success:function(e){200==e.data.code?(t.hideLoading(),t.showToast({icon:"none",title:"上传成功"}),wx.navigateBack({delta:1})):(t.hideLoading(),t.showToast({icon:"none",title:e.data.info}),"未找到登录信息"==e.data.info&&t.reLaunch({url:"/pages/login/login"}))},fail:function(){t.hideLoading(),t.showToast({icon:"none",title:"网络异常,请重试！"})}})):t.showToast({icon:"none",title:"请选择地址！"}):t.showToast({icon:"none",title:"请上传图片！"}):t.showToast({icon:"none",title:"请填入内容！"})},chooseImage:function(){var e=c(i.default.mark(function e(){var n,o=this;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(9!==this.imageList.length){e.next=7;break}return e.next=3,this.isFullImg();case 3:if(n=e.sent,n){e.next=7;break}return t.showToast({icon:"none",title:"最多上传9张图片哦！"}),e.abrupt("return");case 7:t.chooseImage({sourceType:r[this.sourceTypeIndex],sizeType:l[this.sizeTypeIndex],count:this.imageList.length+this.count[this.countIndex]>9?9-this.imageList.length:this.count[this.countIndex],success:function(e){o.imageList=o.imageList.concat(e.tempFilePaths);var n=o.imageList.length;t.showLoading({mask:!0,title:"上传中..."});for(var i=0;i<n;i++)t.uploadFile({url:a.default.websiteUrl+"annexes/uploadmultefile",filePath:e.tempFilePaths[i],fileType:"uploadFile",name:"upload",formData:a.default.postdata({type:"2"}),success:function(e){var i=JSON.parse(e.data);"200"==i.code?(d.push(i.info),n==d.length&&t.hideLoading()):(t.hideLoading(),t.showToast({icon:"none",title:"网络异常,请重试！"}))},fail:function(){t.hideLoading()}})},fail:function(){t.hideLoading(),t.showToast({icon:"none",title:"网络异常,请重试！"})}});case 8:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),isFullImg:function(){return new Promise(function(e){t.showToast({icon:"none",title:"最多上传9张图片!"})})},previewImage:function(e){t.previewImage({current:e,urls:this.imageList})},deleteImage:function(t){this.imageList.splice(t,1),d.splice(t,1)},onChangeAddress:function(){var e=this;t.chooseLocation({success:function(t){e.address=t.address,e.latitude=t.latitude,e.longitude=t.longitude}})}}};e.default=f}).call(this,n("543d")["default"])},a313:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"content"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{value:"",placeholder:"这一刻的想法.....",eventid:"cbf63a66-0"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),n("view",{staticClass:"uni-xz-zp"},[t._l(t.imageList,function(e,i){return n("view",{key:i,staticClass:"uni-img"},[n("image",{attrs:{src:e,mode:"",eventid:"cbf63a66-1-"+i},on:{tap:function(e){t.previewImage(i)}}}),n("image",{staticClass:"uni-delete",attrs:{src:"../../static/gb.png",mode:"",eventid:"cbf63a66-2-"+i},on:{tap:function(e){t.deleteImage(i)}}})])}),n("view",{staticClass:"uni-tj",attrs:{eventid:"cbf63a66-3"},on:{tap:t.chooseImage}},[n("uni-icon",{staticClass:"fa fa-plus",attrs:{mpcomid:"cbf63a66-0"}})],1)],2),n("view",{staticClass:"uni-wz-box",attrs:{eventid:"cbf63a66-4"},on:{tap:t.onChangeAddress}},[n("uni-icon",{staticClass:"fa fa-location-arrow",attrs:{mpcomid:"cbf63a66-1"}}),n("text",[t._v(t._s(t.address))])],1),n("button",{staticClass:"qd_but",attrs:{eventid:"cbf63a66-5"},on:{tap:t.upload_in}},[t._v("上传")])],1)},a=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a})},cbe1:function(t,e,n){"use strict";n.r(e);var i=n("3a2f"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,function(){return i[t]})}(o);e["default"]=a.a},f19c:function(t,e,n){"use strict";n.r(e);var i=n("a313"),a=n("cbe1");for(var o in a)"default"!==o&&function(t){n.d(e,t,function(){return a[t]})}(o);n("03d9");var s=n("2877"),c=Object(s["a"])(a["default"],i["a"],i["b"],!1,null,null,null);e["default"]=c.exports}},[["0236","common/runtime","common/vendor"]]]);