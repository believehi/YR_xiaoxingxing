(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/dakariji"],{"2b6a":function(e,t,i){"use strict";var o=i("f42f"),a=i.n(o);a.a},"55fd":function(e,t,i){"use strict";i.r(t);var o=i("8935"),a=i.n(o);for(var n in o)"default"!==n&&function(e){i.d(t,e,function(){return o[e]})}(n);t["default"]=a.a},"82dd":function(e,t,i){"use strict";i.r(t);var o=i("ed7b"),a=i("55fd");for(var n in a)"default"!==n&&function(e){i.d(t,e,function(){return a[e]})}(n);i("2b6a");var s=i("2877"),c=Object(s["a"])(a["default"],o["a"],o["b"],!1,null,null,null);t["default"]=c.exports},8935:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(i("a34a")),a=n(i("f55d"));function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,o,a,n,s){try{var c=e[n](s),d=c.value}catch(r){return void i(r)}c.done?t(d):Promise.resolve(d).then(o,a)}function c(e){return function(){var t=this,i=arguments;return new Promise(function(o,a){var n=e.apply(t,i);function c(e){s(n,o,a,c,d,"next",e)}function d(e){s(n,o,a,c,d,"throw",e)}c(void 0)})}}var d=i("e3f6"),r=d.formatLocation,l=[["camera"],["album"],["camera","album"]],u=[["compressed"],["original"],["compressed","original"]],f=[],h=null,p=null,m=null,v=null,g=!1,y={data:function(){return{Categoryid:"",Content:"",isok:!0,Issue:!0,Type:!0,video:"",Music:"",Pics:"",Lat:"",lng:"",hasLocation:!1,location:{},locationAddress:"",imageList:[],sourceTypeIndex:2,sizeTypeIndex:2,countIndex:8,count:[1,2,3,4,5,6,7,8,9],srcVideo:"",xspics:[],audioIndex:0,audioMusic:0,audioInit:0,audioLy:0,recording:!1,playing:!1,hasRecord:!1,tempFilePath:"",recordTime:0,playTime:0,formatedRecordTime:"00:00:00",formatedPlayTime:"00:00:00"}},onLoad:function(t){var i=this;a.default.islogin(!0),this.Categoryid=t.Id,this.imageList=[],this.sourceTypeIndex=2,this.sizeTypeIndex=2,this.countIndex=8,f=[],this.xspics=[],v=e.createInnerAudioContext(),v.onEnded(function(){e.hideLoading(),e.showToast({icon:"none",title:"已播放完！",duration:2e3}),clearInterval(h);var t=0;i.audioLy=0,i.playing=!1,i.formatedPlayTime=d.formatTime(t),i.playTime=t}),m=e.getRecorderManager(),m.onStart(function(){}),m.onStop(function(e){i.hasRecord=!0,i.recording=!1,v.src=e.tempFilePath})},methods:{upload_in:function(){if(""!=this.Content)if(""!=this.locationAddress){this.xspics=f,this.Lat=this.location.latitude[0]+"."+this.location.latitude[1],this.lng=this.location.longitude[0]+"."+this.location.longitude[1];for(var t="",i=0;i<this.xspics.length;i++)i==this.xspics.length-1?t+=this.xspics[i]:t+=this.xspics[i]+";";e.request({url:a.default.websiteUrl+"circle/addpost",method:"POST",data:a.default.postdata({userid:a.default.getstate().userid,Categoryid:this.Categoryid,title:"",suvtitle:"",Hits:0,Replay:0,contents:this.Content,isok:this.isok,Issue:this.Issue,Type:this.Type,video:this.video,Music:this.Music,Pics:t,position:this.locationAddress,Lat:this.Lat,lng:this.lng}),success:function(t){200==t.data.code?(e.hideLoading(),wx.navigateBack({delta:1})):(e.hideLoading(),e.showToast({icon:"none",title:t.data.info}),"未找到登录信息"==t.data.info&&e.reLaunch({url:"/pages/login/login"}))},fail:function(){e.hideLoading(),e.showToast({icon:"none",title:"网络异常,请重试！"})}})}else e.showToast({icon:"none",title:"请添加地址！"});else e.showToast({icon:"none",title:"请填入内容！"})},chooseLocation:function(){var t=this;e.chooseLocation({success:function(e){t.hasLocation=!0,t.location=r(e.longitude,e.latitude),t.locationAddress=e.address}})},clear:function(){this.hasLocation=!1},chooseImage:function(){var t=c(o.default.mark(function t(){var i,n=this;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(9!==this.imageList.length){t.next=7;break}return t.next=3,this.isFullImg();case 3:if(i=t.sent,i){t.next=7;break}return e.showToast({icon:"none",title:"最多上传9张图片哦！"}),t.abrupt("return");case 7:e.chooseImage({sourceType:l[this.sourceTypeIndex],sizeType:u[this.sizeTypeIndex],count:this.imageList.length+this.count[this.countIndex]>9?9-this.imageList.length:this.count[this.countIndex],success:function(t){n.imageList=n.imageList.concat(t.tempFilePaths);for(var i=n.imageList.length,o=0;o<i;o++)e.uploadFile({url:a.default.websiteUrl+"annexes/uploadmultefile",filePath:t.tempFilePaths[o],fileType:"uploadFile",name:"upload",formData:a.default.postdata({type:"2"}),success:function(t){var o=JSON.parse(t.data);"200"==o.code?(f.push(o.info),e.showLoading({mask:!0,title:"上传中..."}),i==f.length&&e.hideLoading()):e.showToast({icon:"none",title:"网络异常,请重试！"})},fail:function(){e.hideLoading()}})}});case 8:case"end":return t.stop()}},t,this)}));function i(){return t.apply(this,arguments)}return i}(),isFullImg:function(){return new Promise(function(t){e.showToast({icon:"none",title:"最多上传9张图片!"})})},previewImage:function(t){var i=t.target.dataset.src;e.previewImage({current:i,urls:this.imageList})},deleteImage:function(e){this.imageList.splice(e,1),f.splice(e,1)},chooseVideo:function(){var t=this,i=this;""==i.video?e.chooseVideo({maxDuration:10,count:1,sourceType:["camera","album"],compressed:!0,success:function(o){t.srcVideo=o.tempFilePath+"",e.showLoading({mask:!0,title:"上传中..."}),e.uploadFile({url:a.default.websiteUrl+"annexes/uploadmultefile",filePath:t.srcVideo,fileType:"uploadFile",name:"upload",formData:a.default.postdata({type:1}),success:function(t){var o=JSON.parse(t.data);200==o.code?(i.video=o.info,e.hideLoading()):(e.hideLoading(),e.showToast({icon:"none",title:"网络异常,请重试！"}))},fail:function(){e.hideLoading(),e.showToast({icon:"none",title:"网络异常,请重试！"})}})},fail:function(t){e.hideLoading(),e.showToast({icon:"none",title:"网络异常,请重试！"})}}):e.showToast({icon:"none",title:"已经上传视频了！"})},deleteVideo:function(){this.video=""},startRecord:function(){var t=this;if(this.audioMusic=1,g)return""!=this.Music?void e.showToast({icon:"none",title:"录音已完成"}):void e.showToast({icon:"none",title:"正在录音"});g=!0,this.recording=!0,p=setInterval(function(){t.recordTime+=1,t.formatedRecordTime=d.formatTime(t.recordTime)},1e3),m.start({format:"mp3",duration:6e4})},suspendRecord:function(){this.audioInit=1,clearInterval(p),m.onPause()},resumeRecord:function(){var e=this;this.audioInit=0,m.resume(),p=setInterval(function(){e.recordTime+=1,e.formatedRecordTime=d.formatTime(e.recordTime)},1e3)},wcRecord:function(){var t=this;t.audioInit=0,t.audioIndex=1,m.stop(),clearInterval(p),setTimeout(function(){e.showLoading({mask:!0,title:"上传中..."}),e.uploadFile({url:a.default.websiteUrl+"annexes/uploadmultefile",filePath:v.src,fileType:"uploadFile",name:"upload",formData:a.default.postdata({type:3}),success:function(i){var o=JSON.parse(i.data);"200"==o.code?(e.hideLoading(),e.showToast({icon:"none",title:"录音上传成功！",duration:2e3}),v.src=t.Music=o.info):(e.hideLoading(),e.showToast({icon:"none",title:"录音失败,请重试！",duration:2e3}),t.teleteRecord())},fail:function(){e.hideLoading(),e.showToast({icon:"none",title:"录音失败,请重试！",duration:2e3}),t.teleteRecord()}})},500)},bfRecord:function(){this.audioLy=1,v.play(),e.showLoading({icon:"none",title:"加载中..."}),v.onPlay(function(){e.showLoading({icon:"none",title:"播放中..."})})},ztRecord:function(){this.audioLy=0,v.pause(),e.showToast({icon:"none",title:"已暂停"})},teleteRecord:function(){clearInterval(p),g=!1,this.formatedRecordTime="00:00:00",this.formatedPlayTime="00:00:00",this.audioIndex=0,this.audioMusic=0,this.audioInit=0,this.audioLy=0,this.recordTime=0,this.playTime=0,this.hasRecord=!1,this.recording=!1,this.playing=!1,this.Music="",v.src=""}}};t.default=y}).call(this,i("543d")["default"])},b98f:function(e,t,i){"use strict";i("4651");var o=n(i("b0ce")),a=n(i("82dd"));function n(e){return e&&e.__esModule?e:{default:e}}Page((0,o.default)(a.default))},ed7b:function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("view",{staticClass:"content"},[i("view",{staticClass:"uni-zt-text"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.Content,expression:"Content"}],attrs:{"placeholder-style":"color:#ddd",placeholder:"这一刻的想法...",eventid:"e79ee0ea-0"},domProps:{value:e.Content},on:{input:function(t){t.target.composing||(e.Content=t.target.value)}}}),i("view",{staticClass:"uni-content"},[e._l(e.imageList,function(t,o){return i("view",{key:o},[i("image",{staticClass:"uni-uploader_img",attrs:{src:t,"data-src":t,eventid:"e79ee0ea-1-"+o},on:{tap:e.previewImage}}),i("image",{staticClass:"uni-uploader_icon",attrs:{src:"../../static/gb.png",mode:"",eventid:"e79ee0ea-2-"+o},on:{tap:function(t){e.deleteImage(o)}}})])}),i("view",{style:{display:""==e.video?"none":"inline-block"}},[i("video",{staticClass:"video",attrs:{src:e.video,controls:"false"}}),i("image",{staticClass:"uni-uploader_icon",attrs:{src:"../../static/gb.png",mode:"",eventid:"e79ee0ea-3"},on:{tap:function(t){e.deleteVideo()}}})])],2),i("view",{staticClass:"uni-audio",style:{display:0==e.audioMusic?"none":"block"}},[i("view",{staticClass:"audio-ly",style:{display:0==e.audioIndex?"blcok":"none"}},[i("view",{staticClass:"audio-ly-gb",attrs:{eventid:"e79ee0ea-4"},on:{tap:e.teleteRecord}}),i("view",{staticClass:"audio-ly-sj"},[e._v(e._s(e.formatedRecordTime))]),i("view",{staticClass:"audio-ly-kj"},[i("image",{style:{display:0==e.audioInit?"block":"none"},attrs:{src:"../../static/bofan_02.png",mode:"",eventid:"e79ee0ea-5"},on:{tap:e.suspendRecord}}),i("image",{style:{display:1==e.audioInit?"block":"none"},attrs:{src:"../../static/bofan_01.png",mode:"",eventid:"e79ee0ea-6"},on:{tap:e.resumeRecord}})]),i("view",{staticClass:"audio-ly-ok",attrs:{eventid:"e79ee0ea-7"},on:{tap:e.wcRecord}},[e._v("完成")])]),i("view",{staticClass:"audio-bf",style:{display:1==e.audioIndex?"blcok":"none"}},[i("view",{staticClass:"audio-bf-img"},[i("image",{style:{display:0==e.audioLy?"block":"none"},attrs:{src:"../../static/bofan_03.png",mode:"",eventid:"e79ee0ea-8"},on:{tap:e.bfRecord}}),i("image",{style:{display:1==e.audioLy?"block":"none"},attrs:{src:"../../static/bofan_04.png",mode:"",eventid:"e79ee0ea-9"},on:{tap:e.ztRecord}})]),i("view",{staticClass:"audio-bf-yp"},[e._v("录音音频")]),i("text",[e._v("上传")]),i("image",{staticClass:"audio-bf-delete",attrs:{src:"../../static/gb.png",mode:"",eventid:"e79ee0ea-10"},on:{tap:e.teleteRecord}})])])]),i("view",{staticClass:"uni-tb"},[i("view",[i("image",{attrs:{src:"../../static/ly.png",mode:"",eventid:"e79ee0ea-11"},on:{tap:e.startRecord}})]),i("view",[i("image",{attrs:{src:"../../static/sp.png",mode:"",eventid:"e79ee0ea-12"},on:{tap:e.chooseVideo}})]),i("view",[i("image",{attrs:{src:"../../static/tp.png",mode:"",eventid:"e79ee0ea-13"},on:{tap:e.chooseImage}})])]),i("view",{staticClass:"uni-wz",attrs:{eventid:"e79ee0ea-14"},on:{tap:e.chooseLocation}},[e._m(0),i("text",[e._v(e._s(""==e.locationAddress?"所在位置":e.locationAddress))])]),i("view",{staticClass:"uni-but"},[i("button",{attrs:{eventid:"e79ee0ea-15"},on:{tap:function(t){e.upload_in()}}},[e._v("发 表")])],1),e._m(1)])},a=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("view",[i("image",{attrs:{src:"../../static/dz.png",mode:""}})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("view",{staticClass:"uni-wt"},[i("text",{staticClass:"uni-wt-icon"}),i("text",[e._v("问题反馈")]),i("text",{staticClass:"uni-wt-icon"})])}];i.d(t,"a",function(){return o}),i.d(t,"b",function(){return a})},f42f:function(e,t,i){}},[["b98f","common/runtime","common/vendor"]]]);